{
  "hash": "b96eefc64a51fbef0f008839efc623a2",
  "result": {
    "markdown": "---\ntitle: \"Visualise and handle trees\"\nauthor: Lu√≠s Valente\n---\n\n\n## Phylogeny handling and visualisation in R and Figtree\n\n![](images/FigTree-AR_8-01.png)\n\n### Open your maximum credibility tree in Figtree.\n\nHere you can visualize the tree topology, the posterior probability of different nodes (support values) and the node ages. Explore the different visualisation options in the drop-down menus by trying out different settings.\n\n### Open R to load your tree\n\nNow let's explore some of the functions of R applied to phylogenies.\n\n**Welcome to R**\n\nFirst let's clear your workspace, in case you have some saved objects there that may interfere with the practical\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrm(list=ls())\n```\n:::\n\n\nLoad the necessary packages to run the practical\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ape)\n```\n:::\n\n\nLoad the maximum clade credibility tree you produced in the Beast analysis. Here you need to change the path to the file to match the location on your computer\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncyanistes<-read.nexus('Cyanistes.tre')\n```\n:::\n\n\nLet's see what the `cyanistes` object is\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncyanistes\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nPhylogenetic tree with 70 tips and 69 internal nodes.\n\nTip labels:\n  Cyanistes_caeruleus_KY378741.1, Cyanistes_caeruleus_caeruleus_DQ474042.1, Cyanistes_caeruleus_caeruleus_KP759222.1, Cyanistes_caeruleus_calamensis_JF828080.1, Cyanistes_caeruleus_calamensis_KC202361.1, Cyanistes_caeruleus_calamensis_KP759197.1, ...\n\nRooted; includes branch lengths.\n```\n:::\n:::\n\n\nLet's see what the tip labels are\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncyanistes$tip.label\n```\n:::\n\n\nPlot the phylogeny\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(cyanistes)\n```\n\n::: {.cell-output-display}\n![](handling_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nLooks a bit messy.\n\nPlot with smaller tip labels\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(cyanistes,cex=0.4)\n```\n\n::: {.cell-output-display}\n![](handling_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nAnd a neater version, using the `ladderize` option:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(ladderize(cyanistes),cex=0.4,no.margin=TRUE)\n```\n\n::: {.cell-output-display}\n![](handling_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nCheck if the tree is ultrametric. This is essential for downstream analyses that rely on a dated tree.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nis.ultrametric(cyanistes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n\nPlot the node labels\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(ladderize(cyanistes),cex=0.4,no.margin=TRUE)\nnodelabels(cex=0.3,frame='circle',bg='grey')\n```\n\n::: {.cell-output-display}\n![](handling_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nPlot as a fan.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(ladderize(cyanistes),type='fan',cex=0.3,no.margin=TRUE,)\n```\n\n::: {.cell-output-display}\n![](handling_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nZoom-in on different parts of the tree. With the function below you can click on parts of the tree to see a zoomed-in version.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsubtreeplot(ladderize(cyanistes),cex=0.4)\n```\n:::\n\n\nRemove the outgroup (delete all *Parus* individuals), by creating a new object without all the tips belonging to the outgroup.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncyanistes_ingroup<-drop.tip(cyanistes,c(\"Parus_major_major_KP759174.1\",\n                                         \"Parus_major_DQ792786.1\", \n                                         \"Parus_major_DQ792787.1\",\n                                         \"Parus_major_EU167009.1\", \n                                         \"Parus_major_KJ456375.1\"))\n```\n:::\n\n\nAnd we can now plot the new tree with only the ingroup to check if it worked:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,1))\nplot(ladderize(cyanistes_ingroup),cex=0.4,no.margin=TRUE)\n```\n\n::: {.cell-output-display}\n![](handling_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "handling_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}